---
import Layout from "../layouts/Layout.astro";
import { Image } from "astro:assets";
import helloWorldImage from "../assets/hello_world.jpeg";
import athensImage from "../assets/athens.jpeg";
---

<Layout title="Introduction">
	<div id="background" class="background">
		<pre>
                                                         .,,uod8B8bou,,.
                                             ..,uod8BBBBBBBBBBBBBBBBRPFT?l!i:.
                                        ,=m8BBBBBBBBBBBBBBBRPFT?!||||||||||||||
                                        !...:!TVBBBRPFT||||||||||!!^^""'   ||||
                                        !.......:!?|||||!!^^""'            ||||
                                        !.........||||                     ||||
                                        !.........||||                     ||||
                                        !.........||||                     ||||
                                        !.........||||                     ||||
                                        !.........||||                     ||||
                                        !.........||||                     ||||
                               ┌───┐_____`........||||                    ,||||
                            ┌─ │__.│..uoo.;.......||||              __.-!!|||||
                            ┌─.┘...,uodWBBBBb.....||||       _.-|||||||||||!:'
                         .,uoo~~ !YBBBBBBBBBBBBBBb..!|||:|||!!|||||||!iof68BBBBBb....
                     ..,uoo~~~   !..YBBBBBBBBBBBBBBb!!||||||||!iof68BBBBBBRPFT?!::   `.
                ..,uoo~~~~~      !....YBBBBBBBBBBBBBBbaaitf68BBBBBBRPFT?!:::::::::     `.
           ..,uoo~~~~~           !......YBBBBBBBBBBBBBBBBBBBRPFT?!::::::;:!^"`;:::       `.
       ..,uoo~~~~"               !........YBBBBBBBBBBRPFT?!::::::::::^'' ..::::::;         iBBbo.
  ..,uoo~~~~"                    ...........YPFT?!::::::::::::::::::::::::;iof68bo.        WBBBBbo.
.,u~~~~~~             ,###,      `..........:::::::::::::::::::::::;iof688888888888b.      `YBBBP^'
~~~               ,#BBBBBB8b.      `........::::::::::::::::;iof688888888888888888888b.      `
               "BBBBB"BBBB"""#       `......:::::::::;iof688888888888888888888888888888b.
          #BBBBB B:BBB::BB BB"8b.      `....:::;iof688888888888888888888888888888888899fT!
       ##"B:"B:BBB:::::-BBBBB B"8b.      `..::!8888888888888888888888888888888899fT|!^"'
        `!!8BB:::::`B:BBBBB:BBBBBB8b.      `' !!988888888888888888888888899fT|!^"'
         `!!8BBBB:BBBBB:::::BBB:BBB"8b.        `!!8888888888888888899fT|!^"'
           `!!8   ::::::::BBBBBB  BBB"8b.        `!988888888899fT|!^"'
             `!!8BB ,BB:BBB:`b BB:BBBB"B8b.        `!9899fT|!^"'
               `!!8 BBBBB::B:::::BBBBBB  B8b.        `!^"'
            _    `!!8B ::::::B BB:B  B"fT|!^"
            *Bb.   `!!8 BBBBBBBBB"fT|!^"'
              *Bb.   `!!8 ::BBfT|!^"'
                *Bb.   `!!8|!^"'
                  *Bb.   ""
                    *Bb.
</pre>
		<span id="screentext">hello world</span>
		<span id="screentext2">-> PRESS 'G' <-</span>
		<span id="flashing">_</span>
		<span id="game"></span>
	</div>
	<div class="title-bg">
		<div id="bg-content"></div>
		<div id="bg-content-shape1"></div>
	</div>
	<main class="wrapper">
		<section>
			<h1 id="intro-title">hello.</h1>
			<h3 id="intro-subtitle">welcome to my website.</h3>
		</section>
		<section>
			<h3 class="animated"><u>introduction</u></h3>
			<p>
				<b>Hey there!</b>
			</p>
			<p>
				I'm Stefan–a father of a little human, <a
					href="https://shiftmag.dev/code-quality-good-enough-2034/"
					>a totally average</a
				> software engineer, <a
					href="https://www.youtube.com/watch?v=3acm7j9k_1w"
					>functional caffiene addict</a
				><sup><a href="#fn1" id="ref1">1</a></sup>
				, technology nerd, <a
					href="https://www.youtube.com/watch?v=ypyAg3Zbs_8"
					>design enthusiast</a
				>, <a href="https://www.youtube.com/watch?v=Mt8uLveDY24"
					>midnight gourmand</a
				>, <a
					href="https://trakt.tv/users/commonalpaca/ratings/all/all/rating/asc"
					>film rater</a
				>,
			</p>
			<p>
				This site exists because I wanted to create a place on the
				internet that was completely mine, where I can write articles
				after some crazy thought pops into my head, document some
				deep-dive I've had to do for work or pleasure, share some
				photos, talk about a book, post a travel blog, or just share
				some cool new <i
					><a href="https://www.youtube.com/watch?v=hAtbFwzZp6Y"
						>content™</a
					></i
				> that The Algorithm has decided I should see. There are no cookies,
				trackers, ads or analytics scripts on this site anywhere.
			</p>
			<p>
				If that sounds good, have a look at my <a href="/posts">posts</a
				>, where I'm going to be writing medium to long-form articles
				about whatever is interesting me at the moment. There's also my <a
					href="/cv">CV</a
				> if you're looking to hire, or just want to be nosy, that's cool
				too!
			</p>
			<p>
				Here's one of my favourite quotes I have to come back to after
				spending a long day at work solving problems:
			</p>
			<blockquote cite="https://arc.net/l/quote/msjxkqvk">
				<p>
					the mystery of life isn’t a problem to solve, but a reality
					to experience.
				</p>
				<footer>
					—Frank Herbert, <cite>Dune</cite>
					<p>
						(but the general idea goes back to <a
							href="https://youtu.be/Sb73PRt37o8?si=fwm4jn0tPa7xO__5"
							>Sören Kierkegaard</a
						>)
					</p>
				</footer>
			</blockquote>
		</section>
		<Image
			src={helloWorldImage}
			alt="A picture of a LCD display on a breadboard displaying the text 'hello world!'"
			class="full-bleed index-intro-image"
		/>
		<section>
			<h3 class="animated"><u>five questions</u></h3>
			<blockquote>
				<p>
					Q: Do you have a favourite programming language? If so, what
					is it?
				</p>
			</blockquote>
			<p>
				Not really! I enjoy learning new languages and trying things
				out. I feel most capable working in Python, but I've definitely
				got my personal gripes with it.
			</p>
			<blockquote>
				<p>Q: Favourite type of cuisine?</p>
			</blockquote>
			<p>This is an impossible question to answer.</p>
			<blockquote>
				<p>
					Q: Coolest place you've ever been–don't think too hard, just
					answer.
				</p>
			</blockquote>
			<p>I think it would be Athens, Greece.</p>
			<blockquote>
				<p>Q: Favourite album?</p>
			</blockquote>
			<p>
				Might have to be <a
					href="https://en.wikipedia.org/wiki/Section.80"
					>Section.80</a
				> by Kendrick Lamar. Not because it's his best album (it definitely
				isn't) but because it was the start—and look how far you can go.
			</p>
			<blockquote>
				<p>Q: Favourite film?</p>
			</blockquote>
			<p>
				It's The Dark Knight for me. It's everything a film should be.
				Stylish, edgy, cool, thrilling—they should have just stopped
				making super hero movies after this one.
			</p>
		</section>
		<Image
			src={athensImage}
			alt="A picture of an ancient Greek Doric temple in Athens surrounded by green trees"
			class="full-bleed index-intro-image"
		/>
		<section>
			<h3 class="animated">
				<u
					>an unordered list of people to whom I could listen ramble
					on forever without really getting bored</u
				>
			</h3>
			<p>
				<b>Jim Keller</b>
				– legendary CPU engineer; the lead architect of the <a
					href="https://en.wikipedia.org/wiki/AMD_K8"
					>AMD K8 microarchitecture</a
				>
				(including the original Athlon 64) and the <a
					href="https://en.wikipedia.org/wiki/Apple_A4">Apple A4/A5</a
				>. He was also the coauthor of the specifications for the <a
					href="https://en.wikipedia.org/wiki/X86-64"
					>x86-64 instruction set</a
				> and HyperTransport interconnect and
				<a href="https://youtu.be/gzgyksS5pX8?si=l1IpmlqJRrhVuYgG"
					>has many fascinating talks on youtube</a
				>
			</p>
			<p>
				<b>Robert Sapolsky</b>
				– professor of biology, neurology, neurological sciences, and neurosurgery
				at Stanford University
				<a
					href="https://www.youtube.com/playlist?list=PL848F2368C90DDC3D"
					>has a series of his lectures on youtube</a
				>
			</p>
			<p>
				<b>Scott Galloway</b>
				– Clinical Professor of Marketing at the NYU Stern School of Business
				is
				<a href="https://www.youtube.com/@TheProfGShow">on youtube</a> and
				has some <a href="https://www.youtube.com/watch?v=otyoPiVAicI"
					>great talks</a
				> recorded at conferences.
			</p>
			<p>
				<b>Jon Y (asianometry)</b>
				– makes <i
					>"video essays on business, economics, and history.
					Sometimes about Asia, but not always."</i
				> Loved by <a
					href="https://twitter.com/SwiftOnSecurity/status/1529962165775523845"
					>SwiftOnSecurity</a
				>.
				<a href="https://www.youtube.com/@Asianometry">on youtube</a> and
				<a href="https://www.asianometry.com">on substack</a>
			</p>
			<p>
				<b>Jimmy McGee</b>
				– <i>"reviews games, mostly good ones"."</i>
				<a href="https://www.youtube.com/@JimmyMcG33">on youtube.</a> The
				game reviews are good–but
				<a href="https://youtu.be/-MUEXGaxFDA?si=qnbfo93mApkGWiqh"
					>sometimes</a
				> it's really about... <i>~society~</i>
			</p>
			<p>
				<b
					>Thomas Walter Murphy VII <a
						href="http://tom7.org/index.html">(tom7)</a
					></b
				>
				– does <i>insane</i> crazy amazing Computer Science stuff
				<a href="https://www.youtube.com/@tom7">on youtube</a> like <a
					href="https://www.youtube.com/watch?v=JcJSW7Rprio"
					>implementing a virtual storage device that stores data in
					travelling ICMP echo messages.</a
				> and also does <a href="http://tom7.org/csnotes/"
					>brilliant doodles</a
				> that I hope are never <i>minted</i> into an NFT collection.
			</p>
			<p>
				<b>Ben Eater</b>
				<a href="https://www.youtube.com/@BenEater">on youtube</a>
			</p>
			<p>
				<b>Hamilton Morris</b>
				<a href="https://www.youtube.com/@HamiltonMorris">on youtube</a>
			</p>
			<p>
				<b>Patrick Boyle</b>
				<a href="https://www.youtube.com/@PBoyle">on youtube</a>
			</p>
			<p>
				<b>Dan Carlin</b>
				<a
					href="https://podcasts.apple.com/us/podcast/dan-carlins-hardcore-history/id173001861"
					>Hardcore History</a
				>
			</p>
			<p>
				<b>Dan Olson (Folding Ideas)</b>
				<a href="https://www.youtube.com/@FoldingIdeas">on youtube</a>
			</p>
			<p>
				<b>Posy</b>
				<a href="https://www.youtube.com/@PosyMusic">on youtube</a>
			</p>
			<p>
				<b>Zack Freedman (Voidstar Lab)</b>
				<a href="https://www.youtube.com/@ZackFreedman">on youtube</a>
			</p>
			<p>
				<b>Beau Miles</b>
				<a href="https://www.youtube.com/@BeauMiles">on youtube</a>
			</p>
		</section>
		<section class="footnotes">
			<hr />
			<sup id="fn1"
				>1. This statement relies on a wide-ranging definition of what
				constitutes "functional"–<i>ooh look, footnotes!</i><a
					href="#ref1"
					title="Jump back to footnote 1 in the text.">↩</a
				></sup
			>
			<br />
			<sup id="fn2"
				>2. Full disclosure: I have previously held positions in
				Bitcoin, Ethereum, Litecoin, and others. Luckily I lacked the <i
					>diamond hands</i
				> to HODL until I became a <a
					href="https://youtu.be/aybOOk3llq8?si=8UDdIKbeBj6Ju6sU"
					>bitcoin-millionaire recluse</a
				> paying people to dig secret tunnels under my house in horrendous
				conditions and getting them killed in the process.
				<a href="#ref2" title="Jump back to footnote 2 in the text."
					>↩</a
				></sup
			>
		</section>
	</main>
</Layout>

<style>
	#intro-title {
		margin-top: -80%;
		font-family: Times New Roman;
		letter-spacing: -4px;
		font-size: clamp(4.6rem, 5vw, 6.8rem);
		color: #001fcc;
		display: block;
		transform: translateX(-60px);
		opacity: 0;
	}
	#intro-subtitle {
		font-family: Times New Roman;
		letter-spacing: -1.66px;
		font-weight: 100;
		font-size: 2.3rem;
		color: #001fcc;
		display: block;
		transform: translateX(-60px);
		opacity: 0;
	}
	html.dark > body > .title-bg > #bg-content {
		filter: hue-rotate(236deg) contrast(3.5) brightness(0.6) blur(64px);
	}
	html.dark > body > main.wrapper > section > #intro-title {
		color: #ffffff;
	}
	html.dark > body > main.wrapper > section > #intro-subtitle {
		color: #ffffff;
	}
	.background {
		position: fixed;
		z-index: -1;
		right: 14vw;
		top: 3rem;
		@media (max-width: 700px) {
			top: 10rem;
			right: 0px;
		}
		@media (min-width: 1200px) {
			right: 25vw;
			scale: 1.42;
			top: 12rem;
		}
		pre {
			font-family: monospace;
			font-size: 0.5rem;
			font-weight: 900;
			margin-left: 22px;
			line-height: 10.2px;
			opacity: 0;
		}
		#screentext {
			font-family: monospace;
			font-size: 0.5rem;
			font-weight: 900;
			position: absolute;
			top: 56px;
			left: 289px;
			transform: skew(0deg, -15deg);
			opacity: 0;
		}
		#screentext2 {
			font-family: monospace;
			font-size: 0.4rem;
			font-weight: 900;
			position: absolute;
			top: 113px;
			left: 290px;
			transform: skew(0deg, -15deg);
			opacity: 0;
		}
		#flashing {
			font-family: monospace;
			font-size: 0.5rem;
			font-weight: 900;
			position: absolute;
			top: 47px;
			left: 344px;
			transform: skew(0deg, -15deg);
		}
		#game {
			font-family: monospace;
			font-size: 0.5rem;
			font-weight: 900;
			position: absolute;
			top: 52px;
			left: 289px;
			transform: skew(0deg, -15deg);
			width: 90px;
			line-height: 1;
			letter-spacing: 0.01px;
		}
	}
	blockquote {
		padding-left: 1em;
		border-width: 2px;
		border-left-style: solid;
	}
	.animated {
		display: block;
		transform: translateX(-60px);
		opacity: 0;
	}
	.sub-main-titles {
		position: relative;
		bottom: 6rem;
	}
	.footnotes {
		margin: 8rem 0px 2rem 0px;
	}
</style>

<script>
	import { inView, scroll, animate } from "motion";

	function setupAnimations() {
		inView("#bg-content", ({ target }) => {
			animate(
				// @ts-ignore
				target,
				{
					backgroundSize: ["600px", "1800px"],
					// rotate: ["60deg", "0deg", "60deg"],
					backgroundPositionX: ["0px", "1000px"],
					// width: ["66rem", "120rem"],
					// skewX: ["330deg", "332deg"],
					// skewY: ["330deg", "336deg"],
					// scale: ["1.4", "1.8"],
				},
				{ duration: 10, repeat: Infinity, direction: "alternate" },
			);
		});

		inView("section", ({ target }) => {
			if (target.querySelectorAll(".animated").length === 0) {
				return;
			}
			animate(
				// @ts-ignore
				target.querySelectorAll(".animated"),
				{ opacity: 1, transform: "none" },
				{ delay: 0.2, duration: 0.8, easing: [0.17, 0.55, 0.55, 1] },
			);
		});

		inView(".index-intro-image", ({ target }) => {
			animate(
				// @ts-ignore
				target,
				{ opacity: 1, filter: "grayscale(0)" },
				{ delay: 0.2, duration: 2, easing: [0, 0.25, 0.85, 1] },
			);
		});

		inView("#nav-menu", ({ target }) => {
			animate(
				// @ts-ignore
				document.querySelector("#background"),
				{ filter: "blur(0px) brightness(1)" },
				{ delay: 0, duration: 0.8, easing: [0.37, 0.55, 0.85, 1] },
			);

			return (leaveInfo) => {
				const isDarkMode =
					document.documentElement.classList.contains("dark");
				const backgroundElem = document.querySelector("#background");

				if (!backgroundElem) {
					return;
				}

				if (isDarkMode) {
					animate(
						// @ts-ignore
						backgroundElem,
						{ filter: "blur(4.2px) brightness(0.38)" },
						{
							delay: 0,
							duration: 0.8,
							easing: [0.37, 0.55, 0.85, 1],
						},
					);
					return;
				}
				animate(
					// @ts-ignore
					backgroundElem,
					{ filter: "blur(8.2px) brightness(5.8) contrast(0.2)" },
					{ delay: 0, duration: 0.8, easing: [0.37, 0.55, 0.95, 1] },
				);
			};
		});

		scroll(
			animate("#background", { transform: ["none", `translateY(12vw)`] }),
		);

		// fade in on page load
		["pre", "#screentext", "#screentext2"].forEach((selector) => {
			animate(
				// @ts-ignore
				document.querySelector(selector),
				{ opacity: 1 },
				{ delay: 0.2, duration: 1.6, easing: [0.17, 0.55, 0.55, 1] },
			);
		});

		["#intro-title", "#intro-subtitle"].forEach((selector) => {
			animate(
				// @ts-ignore
				document.querySelector(selector),
				{ opacity: 1, translateX: [-30, 10] },
				{ delay: 0, duration: 1.9, easing: [0.17, 0.55, 0.55, 1] },
			);
		});

		animate(
			// @ts-ignore
			document.querySelector("#flashing"),
			{ opacity: [0, 1, 0] },
			{
				delay: 0,
				duration: 1.6,
				easing: [0.17, 0.95, 0.95, 1],
				repeat: Infinity,
			},
		);
	}

	// hook animations up to View Transitions via after-swap lifecycle hook
	document.addEventListener("astro:page-load", () => {
		if (window.location.pathname === "/") {
			setupAnimations();
		}
	});

	if (typeof localStorage !== "undefined" && localStorage.getItem("theme")) {
		document.getElementById("intro-title")!.innerHTML = "hello, again.";
	}

	setupAnimations();
</script>

<script>
	const gameElem = document.getElementById("game");
	const screenText = document.getElementById("screentext");
	const screenText2 = document.getElementById("screentext2");
	const flashingBit = document.getElementById("flashing");
	const snake = "0";
	const food = ".";
	const lineText = "██████████████████ ";

	let gameStarted = false;
	let grid = lineText.repeat(4) + "█USE█WASD█TO█MOVE█ " + lineText.repeat(4);
	let position = 0;
	let posArr: Array<number> = [];
	let foodPosition = -1;
	let snakeLen = 12;
	let snakeSpeed = 600;
	let playerMoveInterval = null;
	let currentDirectionKey = "";

	function setCharAt(str: string, index: number, chr: string) {
		if (index > str.length - 1) return str;
		grid = str.substring(0, index) + chr + str.substring(index + 1);
		return grid;
	}

	function updateSnakePosition(pos: number) {
		posArr.push(position);
		position = position + pos;

		if (!(foodPosition === position)) {
			posArr.push(position);
		}
		grid = lineText.repeat(9);
	}

	function getNewFoodPos() {
		let newFoodPos = Math.floor(Math.random() * 17 * 9);
		const currSnake = posArr.reverse().slice(0, snakeLen + 1);
		while ((newFoodPos + 1) % 19 === 0 || currSnake.includes(newFoodPos)) {
			newFoodPos = Math.floor(Math.random() * 17 * 9);
		}
		return newFoodPos;
	}

	function handleDirectionKey(key: string) {
		currentDirectionKey = key;

		if (key == "w") {
			if (0 <= position && position <= 17) {
				updateSnakePosition(152);
				return;
			}
			updateSnakePosition(-19);
		}
		if (key == "s") {
			if (position >= 152) {
				updateSnakePosition(-152);
				return;
			}
			updateSnakePosition(19);
		}
		if (key == "a") {
			if (position % 19 === 0) {
				updateSnakePosition(17);
				return;
			}
			updateSnakePosition(-1);
		}
		if (key == "d") {
			if ((position + 2) % 19 === 0) {
				updateSnakePosition(-17);
				return;
			}
			updateSnakePosition(1);
		}
	}

	function keyDownHandler(e: KeyboardEvent, user = true) {
		if (e.key !== "g" && !gameStarted) {
			return;
		}

		if (!gameStarted) {
			gameStarted = true;
			foodPosition = getNewFoodPos();
			screenText!.style.display = "none";
			screenText2!.style.display = "none";
			flashingBit!.style.display = "none";
			gameElem!.style.display = "block";
			grid =
				lineText.repeat(4) + "█USE█WASD█TO█MOVE█ " + lineText.repeat(4);
			posArr = [];
			position = 0;
			foodPosition = 0;
			snakeLen = 12;
			snakeSpeed = 600;
		}

		if (currentDirectionKey === e.key && user) {
			return;
		}

		if (playerMoveInterval!) {
			clearInterval(playerMoveInterval);
		}

		playerMoveInterval = setInterval(
			keyDownHandler,
			snakeSpeed,
			new KeyboardEvent("keydown", { key: e.key }),
			false,
		);

		handleDirectionKey(e.key);

		const currSnake = posArr.reverse().slice(0, snakeLen + 1);

		currSnake.forEach((pos) => {
			gameElem!.innerHTML = setCharAt(grid, pos, snake);
		});
		gameElem!.innerHTML = setCharAt(grid, foodPosition, food);

		if (foodPosition === position) {
			posArr.push(position);
			gameElem!.innerHTML = setCharAt(grid, foodPosition, snake);
			snakeLen++;
			snakeSpeed = snakeSpeed / 1.1;
			foodPosition = getNewFoodPos();
			gameElem!.innerHTML = setCharAt(grid, foodPosition, food);
		}

		if (
			gameStarted &&
			position !== 0 &&
			currSnake.slice(1).includes(position)
		) {
			gameElem!.style.display = "none";
			screenText!.innerHTML = "YOU LOSE :(";
			screenText!.style.display = "block";
			screenText2!.style.display = "block";
			flashingBit!.style.display = "block";
			gameStarted = false;
		}
	}

	document.addEventListener("astro:page-load", () => {
		if (window.location.pathname === "/") {
			window.addEventListener("keydown", (e) => keyDownHandler(e));
		}
	});

	window.addEventListener("keydown", (e) => keyDownHandler(e));
</script>
